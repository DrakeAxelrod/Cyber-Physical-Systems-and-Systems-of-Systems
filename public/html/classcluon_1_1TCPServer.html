<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Cyphy: cluon::TCPServer Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Cyphy
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacecluon.html">cluon</a></li><li class="navelem"><a class="el" href="classcluon_1_1TCPServer.html">TCPServer</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classcluon_1_1TCPServer-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">cluon::TCPServer Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="cluon-complete_8hpp_source.html">cluon-complete.hpp</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for cluon::TCPServer:</div>
<div class="dyncontent">
<div class="center"><img src="classcluon_1_1TCPServer__coll__graph.png" border="0" usemap="#acluon_1_1TCPServer_coll__map" alt="Collaboration graph"/></div>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ab4687285c5779ff7135f388f81d90f50"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcluon_1_1TCPServer.html#ab4687285c5779ff7135f388f81d90f50">TCPServer</a> (uint16_t port, std::function&lt; void(std::string &amp;&amp;from, std::shared_ptr&lt; <a class="el" href="classcluon_1_1TCPConnection.html">cluon::TCPConnection</a> &gt; connection)&gt; newConnectionDelegate) noexcept</td></tr>
<tr class="separator:ab4687285c5779ff7135f388f81d90f50"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33d7e1eeb83b39fa4db9533a25de817c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcluon_1_1TCPServer.html#a33d7e1eeb83b39fa4db9533a25de817c">~TCPServer</a> () noexcept</td></tr>
<tr class="separator:a33d7e1eeb83b39fa4db9533a25de817c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a984878e7f1c210b101fca0caa1ee3e"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcluon_1_1TCPServer.html#a8a984878e7f1c210b101fca0caa1ee3e">isRunning</a> () const noexcept</td></tr>
<tr class="separator:a8a984878e7f1c210b101fca0caa1ee3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-methods" name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:adc6bf24287c819b5472bff52e85d99fb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcluon_1_1TCPServer.html#adc6bf24287c819b5472bff52e85d99fb">TCPServer</a> (const <a class="el" href="classcluon_1_1TCPServer.html">TCPServer</a> &amp;)=delete</td></tr>
<tr class="separator:adc6bf24287c819b5472bff52e85d99fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff56542134616262a7d437e524639485"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcluon_1_1TCPServer.html#aff56542134616262a7d437e524639485">TCPServer</a> (<a class="el" href="classcluon_1_1TCPServer.html">TCPServer</a> &amp;&amp;)=delete</td></tr>
<tr class="separator:aff56542134616262a7d437e524639485"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af28b4fd8278d63140c9dec4b4d8ff0cd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classcluon_1_1TCPServer.html">TCPServer</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcluon_1_1TCPServer.html#af28b4fd8278d63140c9dec4b4d8ff0cd">operator=</a> (const <a class="el" href="classcluon_1_1TCPServer.html">TCPServer</a> &amp;)=delete</td></tr>
<tr class="separator:af28b4fd8278d63140c9dec4b4d8ff0cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3740e3710f2d1e7e79fdc62f133103b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classcluon_1_1TCPServer.html">TCPServer</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcluon_1_1TCPServer.html#aa3740e3710f2d1e7e79fdc62f133103b">operator=</a> (<a class="el" href="classcluon_1_1TCPServer.html">TCPServer</a> &amp;&amp;)=delete</td></tr>
<tr class="separator:aa3740e3710f2d1e7e79fdc62f133103b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7947d2b56d8d4b19bf44c7459e419767"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcluon_1_1TCPServer.html#a7947d2b56d8d4b19bf44c7459e419767">closeSocket</a> (int errorCode) noexcept</td></tr>
<tr class="separator:a7947d2b56d8d4b19bf44c7459e419767"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3383d05f6a75e4298e5b1076161f3043"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcluon_1_1TCPServer.html#a3383d05f6a75e4298e5b1076161f3043">readFromSocket</a> () noexcept</td></tr>
<tr class="separator:a3383d05f6a75e4298e5b1076161f3043"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-attribs" name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a1fbc120d25335332e65fbe53c34ea620"><td class="memItemLeft" align="right" valign="top">std::mutex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcluon_1_1TCPServer.html#a1fbc120d25335332e65fbe53c34ea620">m_socketMutex</a> {}</td></tr>
<tr class="separator:a1fbc120d25335332e65fbe53c34ea620"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4a251600ef878a961a88035468164fb"><td class="memItemLeft" align="right" valign="top">int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcluon_1_1TCPServer.html#aa4a251600ef878a961a88035468164fb">m_socket</a> {-1}</td></tr>
<tr class="separator:aa4a251600ef878a961a88035468164fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ccb65f323775330a184a261f222829e"><td class="memItemLeft" align="right" valign="top">std::atomic&lt; bool &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcluon_1_1TCPServer.html#a8ccb65f323775330a184a261f222829e">m_readFromSocketThreadRunning</a> {false}</td></tr>
<tr class="separator:a8ccb65f323775330a184a261f222829e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd91d5419d724787369636ac3272aa2c"><td class="memItemLeft" align="right" valign="top">std::thread&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcluon_1_1TCPServer.html#afd91d5419d724787369636ac3272aa2c">m_readFromSocketThread</a> {}</td></tr>
<tr class="separator:afd91d5419d724787369636ac3272aa2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88dfa2b0cf7c50dc6320c6d7e756b3ad"><td class="memItemLeft" align="right" valign="top">std::mutex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcluon_1_1TCPServer.html#a88dfa2b0cf7c50dc6320c6d7e756b3ad">m_newConnectionDelegateMutex</a> {}</td></tr>
<tr class="separator:a88dfa2b0cf7c50dc6320c6d7e756b3ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46fec487d263545db1b4834f55efa4c6"><td class="memItemLeft" align="right" valign="top">std::function&lt; void(std::string &amp;&amp;from, std::shared_ptr&lt; <a class="el" href="classcluon_1_1TCPConnection.html">cluon::TCPConnection</a> &gt; connection)&gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcluon_1_1TCPServer.html#a46fec487d263545db1b4834f55efa4c6">m_newConnectionDelegate</a> {}</td></tr>
<tr class="separator:a46fec487d263545db1b4834f55efa4c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="adc6bf24287c819b5472bff52e85d99fb" name="adc6bf24287c819b5472bff52e85d99fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc6bf24287c819b5472bff52e85d99fb">&#9670;&nbsp;</a></span>TCPServer() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">cluon::TCPServer::TCPServer </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classcluon_1_1TCPServer.html">TCPServer</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aff56542134616262a7d437e524639485" name="aff56542134616262a7d437e524639485"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff56542134616262a7d437e524639485">&#9670;&nbsp;</a></span>TCPServer() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">cluon::TCPServer::TCPServer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classcluon_1_1TCPServer.html">TCPServer</a> &amp;&amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ab4687285c5779ff7135f388f81d90f50" name="ab4687285c5779ff7135f388f81d90f50"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4687285c5779ff7135f388f81d90f50">&#9670;&nbsp;</a></span>TCPServer() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">cluon::TCPServer::TCPServer </td>
          <td>(</td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>port</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::function&lt; void(std::string &amp;&amp;from, std::shared_ptr&lt; <a class="el" href="classcluon_1_1TCPConnection.html">cluon::TCPConnection</a> &gt; connection)&gt;&#160;</td>
          <td class="paramname"><em>newConnectionDelegate</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Constructor to create a TCP server.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">port</td><td>Port to receive UDP packets from. </td></tr>
    <tr><td class="paramname">newConnectionDelegate</td><td>Functional to handle incoming TCP connections. </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><span class="lineno">10884</span>    : <a class="code hl_variable" href="classcluon_1_1TCPServer.html#a46fec487d263545db1b4834f55efa4c6">m_newConnectionDelegate</a>(newConnectionDelegate) {</div>
<div class="line"><span class="lineno">10885</span>    <span class="keywordflow">if</span> (0 &lt; port) {</div>
<div class="line"><span class="lineno">10886</span><span class="preprocessor">#ifdef WIN32</span></div>
<div class="line"><span class="lineno">10887</span>        <span class="comment">// Load Winsock 2.2 DLL.</span></div>
<div class="line"><span class="lineno">10888</span>        WSADATA wsaData;</div>
<div class="line"><span class="lineno">10889</span>        <span class="keywordflow">if</span> (WSAStartup(MAKEWORD(2, 2), &amp;wsaData) != 0) {</div>
<div class="line"><span class="lineno">10890</span>            std::cerr &lt;&lt; <span class="stringliteral">&quot;[cluon::TCPServer] Error while calling WSAStartUp: &quot;</span> &lt;&lt; WSAGetLastError() &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">10891</span>        }</div>
<div class="line"><span class="lineno">10892</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">10893</span>        <a class="code hl_variable" href="classcluon_1_1TCPServer.html#aa4a251600ef878a961a88035468164fb">m_socket</a> = ::socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);</div>
<div class="line"><span class="lineno">10894</span> </div>
<div class="line"><span class="lineno">10895</span><span class="preprocessor">#ifdef WIN32</span></div>
<div class="line"><span class="lineno">10896</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classcluon_1_1TCPServer.html#aa4a251600ef878a961a88035468164fb">m_socket</a> &lt; 0) {</div>
<div class="line"><span class="lineno">10897</span>            std::cerr &lt;&lt; <span class="stringliteral">&quot;[cluon::TCPServer] Error while creating socket: &quot;</span> &lt;&lt; WSAGetLastError() &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">10898</span>            WSACleanup();</div>
<div class="line"><span class="lineno">10899</span>        }</div>
<div class="line"><span class="lineno">10900</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">10901</span> </div>
<div class="line"><span class="lineno">10902</span>        <span class="keywordflow">if</span> (!(<a class="code hl_variable" href="classcluon_1_1TCPServer.html#aa4a251600ef878a961a88035468164fb">m_socket</a> &lt; 0)) {</div>
<div class="line"><span class="lineno">10903</span>            <span class="comment">// Allow reusing of ports by multiple calls with same address/port.</span></div>
<div class="line"><span class="lineno">10904</span>            uint32_t YES = 1;</div>
<div class="line"><span class="lineno">10905</span>            <span class="comment">// clang-format off</span></div>
<div class="line"><span class="lineno">10906</span>            <span class="keyword">auto</span> <a class="code hl_variable" href="cluon-complete_8hpp.html#ad4b02d239c8387bc0498b8a690ef5a16">retVal</a> = ::setsockopt(<a class="code hl_variable" href="classcluon_1_1TCPServer.html#aa4a251600ef878a961a88035468164fb">m_socket</a>, SOL_SOCKET, SO_REUSEADDR, <span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span> *<span class="keyword">&gt;</span>(&amp;YES), <span class="keyword">sizeof</span>(YES)); <span class="comment">// NOLINT</span></div>
<div class="line"><span class="lineno">10907</span>            <span class="comment">// clang-format on</span></div>
<div class="line"><span class="lineno">10908</span>            <span class="keywordflow">if</span> (0 &gt; <a class="code hl_variable" href="cluon-complete_8hpp.html#ad4b02d239c8387bc0498b8a690ef5a16">retVal</a>) {</div>
<div class="line"><span class="lineno">10909</span><span class="preprocessor">#ifdef WIN32 </span><span class="comment">// LCOV_EXCL_LINE</span></div>
<div class="line"><span class="lineno">10910</span>                <span class="keyword">auto</span> errorCode = WSAGetLastError();</div>
<div class="line"><span class="lineno">10911</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">10912</span>                <span class="keyword">auto</span> errorCode = errno;                                              <span class="comment">// LCOV_EXCL_LINE</span></div>
<div class="line"><span class="lineno">10913</span><span class="preprocessor">#endif                                  </span><span class="comment">// LCOV_EXCL_LINE</span></div>
<div class="line"><span class="lineno">10914</span>                <a class="code hl_function" href="classcluon_1_1TCPServer.html#a7947d2b56d8d4b19bf44c7459e419767">closeSocket</a>(errorCode); <span class="comment">// LCOV_EXCL_LINE</span></div>
<div class="line"><span class="lineno">10915</span>            }</div>
<div class="line"><span class="lineno">10916</span>        }</div>
<div class="line"><span class="lineno">10917</span> </div>
<div class="line"><span class="lineno">10918</span>        <span class="keywordflow">if</span> (!(<a class="code hl_variable" href="classcluon_1_1TCPServer.html#aa4a251600ef878a961a88035468164fb">m_socket</a> &lt; 0)) {</div>
<div class="line"><span class="lineno">10919</span>            <span class="comment">// Setup address and port.</span></div>
<div class="line"><span class="lineno">10920</span>            <span class="keyword">struct </span>sockaddr_in address;</div>
<div class="line"><span class="lineno">10921</span>            ::memset(&amp;address, 0, <span class="keyword">sizeof</span>(address));</div>
<div class="line"><span class="lineno">10922</span>            address.sin_family      = AF_INET;</div>
<div class="line"><span class="lineno">10923</span>            address.sin_addr.s_addr = htonl(INADDR_ANY);</div>
<div class="line"><span class="lineno">10924</span>            address.sin_port        = htons(port);</div>
<div class="line"><span class="lineno">10925</span> </div>
<div class="line"><span class="lineno">10926</span>            <span class="keyword">auto</span> <a class="code hl_variable" href="cluon-complete_8hpp.html#ad4b02d239c8387bc0498b8a690ef5a16">retVal</a> = ::bind(<a class="code hl_variable" href="classcluon_1_1TCPServer.html#aa4a251600ef878a961a88035468164fb">m_socket</a>, <span class="keyword">reinterpret_cast&lt;</span>struct sockaddr *<span class="keyword">&gt;</span>(&amp;address), <span class="keyword">sizeof</span>(address));</div>
<div class="line"><span class="lineno">10927</span>            <span class="keywordflow">if</span> (-1 != <a class="code hl_variable" href="cluon-complete_8hpp.html#ad4b02d239c8387bc0498b8a690ef5a16">retVal</a>) {</div>
<div class="line"><span class="lineno">10928</span>                <span class="keyword">constexpr</span> int32_t MAX_PENDING_CONNECTIONS{100};</div>
<div class="line"><span class="lineno">10929</span>                <a class="code hl_variable" href="cluon-complete_8hpp.html#ad4b02d239c8387bc0498b8a690ef5a16">retVal</a> = ::listen(<a class="code hl_variable" href="classcluon_1_1TCPServer.html#aa4a251600ef878a961a88035468164fb">m_socket</a>, MAX_PENDING_CONNECTIONS);</div>
<div class="line"><span class="lineno">10930</span>                <span class="keywordflow">if</span> (-1 != <a class="code hl_variable" href="cluon-complete_8hpp.html#ad4b02d239c8387bc0498b8a690ef5a16">retVal</a>) {</div>
<div class="line"><span class="lineno">10931</span>                    <span class="comment">// Constructing a thread could fail.</span></div>
<div class="line"><span class="lineno">10932</span>                    <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">10933</span>                        <a class="code hl_variable" href="classcluon_1_1TCPServer.html#afd91d5419d724787369636ac3272aa2c">m_readFromSocketThread</a> = std::thread(&amp;<a class="code hl_function" href="classcluon_1_1TCPServer.html#a3383d05f6a75e4298e5b1076161f3043">TCPServer::readFromSocket</a>, <span class="keyword">this</span>);</div>
<div class="line"><span class="lineno">10934</span> </div>
<div class="line"><span class="lineno">10935</span>                        <span class="comment">// Let the operating system spawn the thread.</span></div>
<div class="line"><span class="lineno">10936</span>                        <span class="keyword">using namespace </span>std::literals::chrono_literals;</div>
<div class="line"><span class="lineno">10937</span>                        <span class="keywordflow">do</span> { std::this_thread::sleep_for(1ms); } <span class="keywordflow">while</span> (!<a class="code hl_variable" href="classcluon_1_1TCPServer.html#a8ccb65f323775330a184a261f222829e">m_readFromSocketThreadRunning</a>.load());</div>
<div class="line"><span class="lineno">10938</span>                    } <span class="keywordflow">catch</span> (...) {          <span class="comment">// LCOV_EXCL_LINE</span></div>
<div class="line"><span class="lineno">10939</span>                        <a class="code hl_function" href="classcluon_1_1TCPServer.html#a7947d2b56d8d4b19bf44c7459e419767">closeSocket</a>(ECHILD); <span class="comment">// LCOV_EXCL_LINE</span></div>
<div class="line"><span class="lineno">10940</span>                    }</div>
<div class="line"><span class="lineno">10941</span>                } <span class="keywordflow">else</span> { <span class="comment">// LCOV_EXCL_LINE</span></div>
<div class="line"><span class="lineno">10942</span><span class="preprocessor">#ifdef WIN32             </span><span class="comment">// LCOV_EXCL_LINE</span></div>
<div class="line"><span class="lineno">10943</span>                    <span class="keyword">auto</span> errorCode = WSAGetLastError();</div>
<div class="line"><span class="lineno">10944</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">10945</span>                    <span class="keyword">auto</span> errorCode = errno;                                          <span class="comment">// LCOV_EXCL_LINE</span></div>
<div class="line"><span class="lineno">10946</span><span class="preprocessor">#endif                                      </span><span class="comment">// LCOV_EXCL_LINE</span></div>
<div class="line"><span class="lineno">10947</span>                    <a class="code hl_function" href="classcluon_1_1TCPServer.html#a7947d2b56d8d4b19bf44c7459e419767">closeSocket</a>(errorCode); <span class="comment">// LCOV_EXCL_LINE</span></div>
<div class="line"><span class="lineno">10948</span>                }</div>
<div class="line"><span class="lineno">10949</span>            } <span class="keywordflow">else</span> { <span class="comment">// LCOV_EXCL_LINE</span></div>
<div class="line"><span class="lineno">10950</span><span class="preprocessor">#ifdef WIN32         </span><span class="comment">// LCOV_EXCL_LINE</span></div>
<div class="line"><span class="lineno">10951</span>                <span class="keyword">auto</span> errorCode = WSAGetLastError();</div>
<div class="line"><span class="lineno">10952</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">10953</span>                <span class="keyword">auto</span> errorCode = errno;                                              <span class="comment">// LCOV_EXCL_LINE</span></div>
<div class="line"><span class="lineno">10954</span><span class="preprocessor">#endif                                  </span><span class="comment">// LCOV_EXCL_LINE</span></div>
<div class="line"><span class="lineno">10955</span>                <a class="code hl_function" href="classcluon_1_1TCPServer.html#a7947d2b56d8d4b19bf44c7459e419767">closeSocket</a>(errorCode); <span class="comment">// LCOV_EXCL_LINE</span></div>
<div class="line"><span class="lineno">10956</span>            }</div>
<div class="line"><span class="lineno">10957</span>        }</div>
<div class="line"><span class="lineno">10958</span>    }</div>
<div class="line"><span class="lineno">10959</span>}</div>
<div class="ttc" id="aclasscluon_1_1TCPServer_html_a3383d05f6a75e4298e5b1076161f3043"><div class="ttname"><a href="classcluon_1_1TCPServer.html#a3383d05f6a75e4298e5b1076161f3043">cluon::TCPServer::readFromSocket</a></div><div class="ttdeci">void readFromSocket() noexcept</div><div class="ttdef"><b>Definition:</b> cluon-complete.hpp:11002</div></div>
<div class="ttc" id="aclasscluon_1_1TCPServer_html_a46fec487d263545db1b4834f55efa4c6"><div class="ttname"><a href="classcluon_1_1TCPServer.html#a46fec487d263545db1b4834f55efa4c6">cluon::TCPServer::m_newConnectionDelegate</a></div><div class="ttdeci">std::function&lt; void(std::string &amp;&amp;from, std::shared_ptr&lt; cluon::TCPConnection &gt; connection)&gt; m_newConnectionDelegate</div><div class="ttdef"><b>Definition:</b> cluon-complete.hpp:6726</div></div>
<div class="ttc" id="aclasscluon_1_1TCPServer_html_a7947d2b56d8d4b19bf44c7459e419767"><div class="ttname"><a href="classcluon_1_1TCPServer.html#a7947d2b56d8d4b19bf44c7459e419767">cluon::TCPServer::closeSocket</a></div><div class="ttdeci">void closeSocket(int errorCode) noexcept</div><div class="ttdef"><b>Definition:</b> cluon-complete.hpp:10975</div></div>
<div class="ttc" id="aclasscluon_1_1TCPServer_html_a8ccb65f323775330a184a261f222829e"><div class="ttname"><a href="classcluon_1_1TCPServer.html#a8ccb65f323775330a184a261f222829e">cluon::TCPServer::m_readFromSocketThreadRunning</a></div><div class="ttdeci">std::atomic&lt; bool &gt; m_readFromSocketThreadRunning</div><div class="ttdef"><b>Definition:</b> cluon-complete.hpp:6722</div></div>
<div class="ttc" id="aclasscluon_1_1TCPServer_html_aa4a251600ef878a961a88035468164fb"><div class="ttname"><a href="classcluon_1_1TCPServer.html#aa4a251600ef878a961a88035468164fb">cluon::TCPServer::m_socket</a></div><div class="ttdeci">int32_t m_socket</div><div class="ttdef"><b>Definition:</b> cluon-complete.hpp:6720</div></div>
<div class="ttc" id="aclasscluon_1_1TCPServer_html_afd91d5419d724787369636ac3272aa2c"><div class="ttname"><a href="classcluon_1_1TCPServer.html#afd91d5419d724787369636ac3272aa2c">cluon::TCPServer::m_readFromSocketThread</a></div><div class="ttdeci">std::thread m_readFromSocketThread</div><div class="ttdef"><b>Definition:</b> cluon-complete.hpp:6723</div></div>
<div class="ttc" id="acluon-complete_8hpp_html_ad4b02d239c8387bc0498b8a690ef5a16"><div class="ttname"><a href="cluon-complete_8hpp.html#ad4b02d239c8387bc0498b8a690ef5a16">retVal</a></div><div class="ttdeci">std::pair&lt; std::vector&lt; MetaMessage &gt;, MessageParserErrorCodes &gt; retVal</div><div class="ttdef"><b>Definition:</b> cluon-complete.hpp:9859</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classcluon_1_1TCPServer.html#a3383d05f6a75e4298e5b1076161f3043">readFromSocket()</a>, and <a class="el" href="cluon-complete_8hpp.html#ad4b02d239c8387bc0498b8a690ef5a16">retVal</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcluon_1_1TCPServer_ab4687285c5779ff7135f388f81d90f50_cgraph.png" border="0" usemap="#aclasscluon_1_1TCPServer_ab4687285c5779ff7135f388f81d90f50_cgraph" alt=""/></div>
</div>

</div>
</div>
<a id="a33d7e1eeb83b39fa4db9533a25de817c" name="a33d7e1eeb83b39fa4db9533a25de817c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a33d7e1eeb83b39fa4db9533a25de817c">&#9670;&nbsp;</a></span>~TCPServer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">cluon::TCPServer::~TCPServer </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">10961</span>                                      {</div>
<div class="line"><span class="lineno">10962</span>    <a class="code hl_variable" href="classcluon_1_1TCPServer.html#a8ccb65f323775330a184a261f222829e">m_readFromSocketThreadRunning</a>.store(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">10963</span> </div>
<div class="line"><span class="lineno">10964</span>    <span class="comment">// Joining the thread could fail.</span></div>
<div class="line"><span class="lineno">10965</span>    <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">10966</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classcluon_1_1TCPServer.html#afd91d5419d724787369636ac3272aa2c">m_readFromSocketThread</a>.joinable()) {</div>
<div class="line"><span class="lineno">10967</span>            <a class="code hl_variable" href="classcluon_1_1TCPServer.html#afd91d5419d724787369636ac3272aa2c">m_readFromSocketThread</a>.join();</div>
<div class="line"><span class="lineno">10968</span>        }</div>
<div class="line"><span class="lineno">10969</span>    } <span class="keywordflow">catch</span> (...) { <span class="comment">// LCOV_EXCL_LINE</span></div>
<div class="line"><span class="lineno">10970</span>    }</div>
<div class="line"><span class="lineno">10971</span> </div>
<div class="line"><span class="lineno">10972</span>    <a class="code hl_function" href="classcluon_1_1TCPServer.html#a7947d2b56d8d4b19bf44c7459e419767">closeSocket</a>(0);</div>
<div class="line"><span class="lineno">10973</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classcluon_1_1TCPServer.html#a7947d2b56d8d4b19bf44c7459e419767">closeSocket()</a>, <a class="el" href="classcluon_1_1TCPServer.html#afd91d5419d724787369636ac3272aa2c">m_readFromSocketThread</a>, and <a class="el" href="classcluon_1_1TCPServer.html#a8ccb65f323775330a184a261f222829e">m_readFromSocketThreadRunning</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcluon_1_1TCPServer_a33d7e1eeb83b39fa4db9533a25de817c_cgraph.png" border="0" usemap="#aclasscluon_1_1TCPServer_a33d7e1eeb83b39fa4db9533a25de817c_cgraph" alt=""/></div>
</div>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a7947d2b56d8d4b19bf44c7459e419767" name="a7947d2b56d8d4b19bf44c7459e419767"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7947d2b56d8d4b19bf44c7459e419767">&#9670;&nbsp;</a></span>closeSocket()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void cluon::TCPServer::closeSocket </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>errorCode</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >This method closes the socket.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">errorCode</td><td>Error code that caused this closing. </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><span class="lineno">10975</span>                                                         {</div>
<div class="line"><span class="lineno">10976</span>    <span class="keywordflow">if</span> (0 != errorCode) {</div>
<div class="line"><span class="lineno">10977</span>        std::cerr &lt;&lt; <span class="stringliteral">&quot;[cluon::TCPServer] Failed to perform socket operation: &quot;</span>; <span class="comment">// LCOV_EXCL_LINE</span></div>
<div class="line"><span class="lineno">10978</span><span class="preprocessor">#ifdef WIN32                                                                    </span><span class="comment">// LCOV_EXCL_LINE</span></div>
<div class="line"><span class="lineno">10979</span>        std::cerr &lt;&lt; errorCode &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">10980</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">10981</span>        std::cerr &lt;&lt; ::strerror(errorCode) &lt;&lt; <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; errorCode &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl; <span class="comment">// LCOV_EXCL_LINE</span></div>
<div class="line"><span class="lineno">10982</span><span class="preprocessor">#endif </span><span class="comment">// LCOV_EXCL_LINE</span></div>
<div class="line"><span class="lineno">10983</span>    }</div>
<div class="line"><span class="lineno">10984</span> </div>
<div class="line"><span class="lineno">10985</span>    <span class="keywordflow">if</span> (!(<a class="code hl_variable" href="classcluon_1_1TCPServer.html#aa4a251600ef878a961a88035468164fb">m_socket</a> &lt; 0)) {</div>
<div class="line"><span class="lineno">10986</span><span class="preprocessor">#ifdef WIN32</span></div>
<div class="line"><span class="lineno">10987</span>        ::shutdown(<a class="code hl_variable" href="classcluon_1_1TCPServer.html#aa4a251600ef878a961a88035468164fb">m_socket</a>, SD_BOTH);</div>
<div class="line"><span class="lineno">10988</span>        ::closesocket(<a class="code hl_variable" href="classcluon_1_1TCPServer.html#aa4a251600ef878a961a88035468164fb">m_socket</a>);</div>
<div class="line"><span class="lineno">10989</span>        WSACleanup();</div>
<div class="line"><span class="lineno">10990</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">10991</span>        ::shutdown(<a class="code hl_variable" href="classcluon_1_1TCPServer.html#aa4a251600ef878a961a88035468164fb">m_socket</a>, SHUT_RDWR);                                             <span class="comment">// Disallow further read/write operations.</span></div>
<div class="line"><span class="lineno">10992</span>        ::close(<a class="code hl_variable" href="classcluon_1_1TCPServer.html#aa4a251600ef878a961a88035468164fb">m_socket</a>);</div>
<div class="line"><span class="lineno">10993</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">10994</span>    }</div>
<div class="line"><span class="lineno">10995</span>    <a class="code hl_variable" href="classcluon_1_1TCPServer.html#aa4a251600ef878a961a88035468164fb">m_socket</a> = -1;</div>
<div class="line"><span class="lineno">10996</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classcluon_1_1TCPServer.html#a33d7e1eeb83b39fa4db9533a25de817c">~TCPServer()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcluon_1_1TCPServer_a7947d2b56d8d4b19bf44c7459e419767_icgraph.png" border="0" usemap="#aclasscluon_1_1TCPServer_a7947d2b56d8d4b19bf44c7459e419767_icgraph" alt=""/></div>
</div>

</div>
</div>
<a id="a8a984878e7f1c210b101fca0caa1ee3e" name="a8a984878e7f1c210b101fca0caa1ee3e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a984878e7f1c210b101fca0caa1ee3e">&#9670;&nbsp;</a></span>isRunning()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool cluon::TCPServer::isRunning </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>true if the <a class="el" href="classcluon_1_1TCPServer.html">TCPServer</a> could successfully be created and is able to receive data. </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">10998</span>                                                {</div>
<div class="line"><span class="lineno">10999</span>    <span class="keywordflow">return</span> (<a class="code hl_variable" href="classcluon_1_1TCPServer.html#a8ccb65f323775330a184a261f222829e">m_readFromSocketThreadRunning</a>.load() &amp;&amp; !<a class="code hl_function" href="classcluon_1_1TerminateHandler.html#a14570735df2bf9965520a022879b2a56">TerminateHandler::instance</a>().<a class="code hl_variable" href="classcluon_1_1TerminateHandler.html#a81d8eacbcfc121e0cf4a2d303b84ab8a">isTerminated</a>.load());</div>
<div class="line"><span class="lineno">11000</span>}</div>
<div class="ttc" id="aclasscluon_1_1TerminateHandler_html_a14570735df2bf9965520a022879b2a56"><div class="ttname"><a href="classcluon_1_1TerminateHandler.html#a14570735df2bf9965520a022879b2a56">cluon::TerminateHandler::instance</a></div><div class="ttdeci">static TerminateHandler &amp; instance() noexcept</div><div class="ttdef"><b>Definition:</b> cluon-complete.hpp:6067</div></div>
<div class="ttc" id="aclasscluon_1_1TerminateHandler_html_a81d8eacbcfc121e0cf4a2d303b84ab8a"><div class="ttname"><a href="classcluon_1_1TerminateHandler.html#a81d8eacbcfc121e0cf4a2d303b84ab8a">cluon::TerminateHandler::isTerminated</a></div><div class="ttdeci">std::atomic&lt; bool &gt; isTerminated</div><div class="ttdef"><b>Definition:</b> cluon-complete.hpp:6075</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classcluon_1_1TerminateHandler.html#a14570735df2bf9965520a022879b2a56">cluon::TerminateHandler::instance()</a>, <a class="el" href="classcluon_1_1TerminateHandler.html#a81d8eacbcfc121e0cf4a2d303b84ab8a">cluon::TerminateHandler::isTerminated</a>, and <a class="el" href="classcluon_1_1TCPServer.html#a8ccb65f323775330a184a261f222829e">m_readFromSocketThreadRunning</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcluon_1_1TCPServer_a8a984878e7f1c210b101fca0caa1ee3e_cgraph.png" border="0" usemap="#aclasscluon_1_1TCPServer_a8a984878e7f1c210b101fca0caa1ee3e_cgraph" alt=""/></div>
</div>

</div>
</div>
<a id="af28b4fd8278d63140c9dec4b4d8ff0cd" name="af28b4fd8278d63140c9dec4b4d8ff0cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af28b4fd8278d63140c9dec4b4d8ff0cd">&#9670;&nbsp;</a></span>operator=() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classcluon_1_1TCPServer.html">TCPServer</a> &amp; cluon::TCPServer::operator= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classcluon_1_1TCPServer.html">TCPServer</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aa3740e3710f2d1e7e79fdc62f133103b" name="aa3740e3710f2d1e7e79fdc62f133103b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3740e3710f2d1e7e79fdc62f133103b">&#9670;&nbsp;</a></span>operator=() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classcluon_1_1TCPServer.html">TCPServer</a> &amp; cluon::TCPServer::operator= </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classcluon_1_1TCPServer.html">TCPServer</a> &amp;&amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a3383d05f6a75e4298e5b1076161f3043" name="a3383d05f6a75e4298e5b1076161f3043"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3383d05f6a75e4298e5b1076161f3043">&#9670;&nbsp;</a></span>readFromSocket()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void cluon::TCPServer::readFromSocket </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">11002</span>                                               {</div>
<div class="line"><span class="lineno">11003</span>    <span class="keyword">struct </span>timeval timeout {};</div>
<div class="line"><span class="lineno">11004</span> </div>
<div class="line"><span class="lineno">11005</span>    <span class="comment">// Define file descriptor set to watch for read operations.</span></div>
<div class="line"><span class="lineno">11006</span>    fd_set setOfFiledescriptorsToReadFrom{};</div>
<div class="line"><span class="lineno">11007</span> </div>
<div class="line"><span class="lineno">11008</span>    <span class="comment">// Indicate to main thread that we are ready.</span></div>
<div class="line"><span class="lineno">11009</span>    <a class="code hl_variable" href="classcluon_1_1TCPServer.html#a8ccb65f323775330a184a261f222829e">m_readFromSocketThreadRunning</a>.store(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">11010</span> </div>
<div class="line"><span class="lineno">11011</span>    <span class="keyword">constexpr</span> uint16_t MAX_ADDR_SIZE{1024};</div>
<div class="line"><span class="lineno">11012</span>    std::array&lt;char, MAX_ADDR_SIZE&gt; remoteAddress{};</div>
<div class="line"><span class="lineno">11013</span> </div>
<div class="line"><span class="lineno">11014</span>    <span class="keywordflow">while</span> (<a class="code hl_variable" href="classcluon_1_1TCPServer.html#a8ccb65f323775330a184a261f222829e">m_readFromSocketThreadRunning</a>.load()) {</div>
<div class="line"><span class="lineno">11015</span>        <span class="comment">// Define timeout for select system call. The timeval struct must be</span></div>
<div class="line"><span class="lineno">11016</span>        <span class="comment">// reinitialized for every select call as it might be modified containing</span></div>
<div class="line"><span class="lineno">11017</span>        <span class="comment">// the actual time slept.</span></div>
<div class="line"><span class="lineno">11018</span>        timeout.tv_sec  = 0;</div>
<div class="line"><span class="lineno">11019</span>        timeout.tv_usec = 20 * 1000; <span class="comment">// Check for new data with 50Hz.</span></div>
<div class="line"><span class="lineno">11020</span> </div>
<div class="line"><span class="lineno">11021</span>        FD_ZERO(&amp;setOfFiledescriptorsToReadFrom);</div>
<div class="line"><span class="lineno">11022</span>        FD_SET(<a class="code hl_variable" href="classcluon_1_1TCPServer.html#aa4a251600ef878a961a88035468164fb">m_socket</a>, &amp;setOfFiledescriptorsToReadFrom);</div>
<div class="line"><span class="lineno">11023</span>        ::select(<a class="code hl_variable" href="classcluon_1_1TCPServer.html#aa4a251600ef878a961a88035468164fb">m_socket</a> + 1, &amp;setOfFiledescriptorsToReadFrom, <span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>, &amp;timeout);</div>
<div class="line"><span class="lineno">11024</span>        <span class="keywordflow">if</span> (FD_ISSET(<a class="code hl_variable" href="classcluon_1_1TCPServer.html#aa4a251600ef878a961a88035468164fb">m_socket</a>, &amp;setOfFiledescriptorsToReadFrom)) {</div>
<div class="line"><span class="lineno">11025</span>            <span class="keyword">struct </span>sockaddr_storage remote;</div>
<div class="line"><span class="lineno">11026</span>            socklen_t addrLength     = <span class="keyword">sizeof</span>(remote);</div>
<div class="line"><span class="lineno">11027</span>            int32_t connectingClient = ::accept(<a class="code hl_variable" href="classcluon_1_1TCPServer.html#aa4a251600ef878a961a88035468164fb">m_socket</a>, <span class="keyword">reinterpret_cast&lt;</span>struct sockaddr *<span class="keyword">&gt;</span>(&amp;remote), &amp;addrLength);</div>
<div class="line"><span class="lineno">11028</span>            <span class="keywordflow">if</span> ((0 &lt;= connectingClient) &amp;&amp; (<span class="keyword">nullptr</span> != <a class="code hl_variable" href="classcluon_1_1TCPServer.html#a46fec487d263545db1b4834f55efa4c6">m_newConnectionDelegate</a>)) {</div>
<div class="line"><span class="lineno">11029</span>                ::inet_ntop(remote.ss_family,</div>
<div class="line"><span class="lineno">11030</span>                            &amp;((<span class="keyword">reinterpret_cast&lt;</span>struct sockaddr_in *<span class="keyword">&gt;</span>(&amp;remote))-&gt;sin_addr), <span class="comment">// NOLINT</span></div>
<div class="line"><span class="lineno">11031</span>                            remoteAddress.data(),</div>
<div class="line"><span class="lineno">11032</span>                            remoteAddress.max_size());</div>
<div class="line"><span class="lineno">11033</span>                <span class="keyword">const</span> uint16_t RECVFROM_PORT{ntohs(<span class="keyword">reinterpret_cast&lt;</span>struct sockaddr_in *<span class="keyword">&gt;</span>(&amp;remote)-&gt;sin_port)}; <span class="comment">// NOLINT</span></div>
<div class="line"><span class="lineno">11034</span>                <a class="code hl_variable" href="classcluon_1_1TCPServer.html#a46fec487d263545db1b4834f55efa4c6">m_newConnectionDelegate</a>(std::string(remoteAddress.data()) + <span class="charliteral">&#39;:&#39;</span> + std::to_string(RECVFROM_PORT),</div>
<div class="line"><span class="lineno">11035</span>                                        std::shared_ptr&lt;cluon::TCPConnection&gt;(<span class="keyword">new</span> <a class="code hl_class" href="classcluon_1_1TCPConnection.html">cluon::TCPConnection</a>(connectingClient)));</div>
<div class="line"><span class="lineno">11036</span>            }</div>
<div class="line"><span class="lineno">11037</span>        }</div>
<div class="line"><span class="lineno">11038</span>    }</div>
<div class="line"><span class="lineno">11039</span>}</div>
<div class="ttc" id="aclasscluon_1_1TCPConnection_html"><div class="ttname"><a href="classcluon_1_1TCPConnection.html">cluon::TCPConnection</a></div><div class="ttdef"><b>Definition:</b> cluon-complete.hpp:6567</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classcluon_1_1TCPServer.html#a46fec487d263545db1b4834f55efa4c6">m_newConnectionDelegate</a>, <a class="el" href="classcluon_1_1TCPServer.html#a8ccb65f323775330a184a261f222829e">m_readFromSocketThreadRunning</a>, and <a class="el" href="classcluon_1_1TCPServer.html#aa4a251600ef878a961a88035468164fb">m_socket</a>.</p>

<p class="reference">Referenced by <a class="el" href="classcluon_1_1TCPServer.html#ab4687285c5779ff7135f388f81d90f50">TCPServer()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcluon_1_1TCPServer_a3383d05f6a75e4298e5b1076161f3043_icgraph.png" border="0" usemap="#aclasscluon_1_1TCPServer_a3383d05f6a75e4298e5b1076161f3043_icgraph" alt=""/></div>
</div>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a46fec487d263545db1b4834f55efa4c6" name="a46fec487d263545db1b4834f55efa4c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a46fec487d263545db1b4834f55efa4c6">&#9670;&nbsp;</a></span>m_newConnectionDelegate</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::function&lt;void(std::string &amp;&amp;from, std::shared_ptr&lt;<a class="el" href="classcluon_1_1TCPConnection.html">cluon::TCPConnection</a>&gt; connection)&gt; cluon::TCPServer::m_newConnectionDelegate {}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classcluon_1_1TCPServer.html#a3383d05f6a75e4298e5b1076161f3043">readFromSocket()</a>.</p>

</div>
</div>
<a id="a88dfa2b0cf7c50dc6320c6d7e756b3ad" name="a88dfa2b0cf7c50dc6320c6d7e756b3ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88dfa2b0cf7c50dc6320c6d7e756b3ad">&#9670;&nbsp;</a></span>m_newConnectionDelegateMutex</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::mutex cluon::TCPServer::m_newConnectionDelegateMutex {}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="afd91d5419d724787369636ac3272aa2c" name="afd91d5419d724787369636ac3272aa2c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd91d5419d724787369636ac3272aa2c">&#9670;&nbsp;</a></span>m_readFromSocketThread</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::thread cluon::TCPServer::m_readFromSocketThread {}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classcluon_1_1TCPServer.html#a33d7e1eeb83b39fa4db9533a25de817c">~TCPServer()</a>.</p>

</div>
</div>
<a id="a8ccb65f323775330a184a261f222829e" name="a8ccb65f323775330a184a261f222829e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ccb65f323775330a184a261f222829e">&#9670;&nbsp;</a></span>m_readFromSocketThreadRunning</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::atomic&lt;bool&gt; cluon::TCPServer::m_readFromSocketThreadRunning {false}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classcluon_1_1TCPServer.html#a8a984878e7f1c210b101fca0caa1ee3e">isRunning()</a>, <a class="el" href="classcluon_1_1TCPServer.html#a3383d05f6a75e4298e5b1076161f3043">readFromSocket()</a>, and <a class="el" href="classcluon_1_1TCPServer.html#a33d7e1eeb83b39fa4db9533a25de817c">~TCPServer()</a>.</p>

</div>
</div>
<a id="aa4a251600ef878a961a88035468164fb" name="aa4a251600ef878a961a88035468164fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4a251600ef878a961a88035468164fb">&#9670;&nbsp;</a></span>m_socket</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int32_t cluon::TCPServer::m_socket {-1}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="classcluon_1_1TCPServer.html#a3383d05f6a75e4298e5b1076161f3043">readFromSocket()</a>.</p>

</div>
</div>
<a id="a1fbc120d25335332e65fbe53c34ea620" name="a1fbc120d25335332e65fbe53c34ea620"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1fbc120d25335332e65fbe53c34ea620">&#9670;&nbsp;</a></span>m_socketMutex</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::mutex cluon::TCPServer::m_socketMutex {}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">mutable</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>src/<a class="el" href="cluon-complete_8hpp_source.html">cluon-complete.hpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3
</small></address>
</body>
</html>
